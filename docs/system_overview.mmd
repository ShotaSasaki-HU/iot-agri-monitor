---
config:
  layout: dagre
---
flowchart LR
 subgraph WAN["Internet"]
        CDSE["ğŸ›°ï¸ COPERNICUS DATA SPACE<br>(openEO API)"]
  end
 subgraph Edge["Publisher (Raspberry Pi)"]
        Logic{"çªãåˆã‚ã›åˆ¤å®š"}
        Sensor("ä»®æƒ³ã®<br>åœŸå£Œæ°´åˆ†ã‚»ãƒ³ã‚µ")
  end
 subgraph Server["Docker Container"]
        subgraph Broker["Broker"]
            Mosquitto("Mosquitto")
        end
        subgraph Subscriber["Subscriber"]
            Telegraf("Telegraf")
            DB[("InfluxDB")]
            Dash("Grafana")
        end
  end
 subgraph LAN["LAN"]
        Edge
        Server
  end
    Sensor --> Logic
    CDSE -- HTTPS --> Logic
    Logic == MQTTS ==> Mosquitto
    Mosquitto == MQTTS ==> Telegraf
    Telegraf --> DB
    DB --> Dash

      CDSE:::internet
    classDef internet fill:#e1f5fe,stroke:#01579b,stroke-width:2px
      Edge:::edge
    classDef edge fill:#fdecea,stroke:#c62828,stroke-width:2px
      Server:::server
    classDef server fill:#e3f2fd,stroke:#1565c0,stroke-width:2px
